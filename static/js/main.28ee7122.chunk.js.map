{"version":3,"sources":["components/pixi/Viewport.tsx","components/pixi/Label.tsx","components/Map.tsx","App.tsx","components/pixi/ParticleEmitter.ts","components/Overview.tsx","serviceWorker.ts","index.tsx"],"names":["Viewport","React","forwardRef","props","ref","app","useApp","cursor","process","renderer","plugins","interaction","cursorStyles","pointer","PixiComponentViewport","PixiComponent","create","viewport","PixiViewport","screenWidth","screenHeight","worldWidth","worldHeight","ticker","minScale","maxScale","drag","pinch","wheel","clamp","direction","clampZoom","decelerate","Label","textRef","useRef","text","style","useMemo","PIXI","align","lineHeight","wordWrap","wordWrapWidth","labelWidth","fontFamily","fontSize","textBaseline","fontWeight","textBoxHeight","metrics","measureText","Math","min","height","useEffect","textCmp","current","maskGraphics","beginFill","drawRect","padding","endFill","mask","addChild","interactive","anchor","draw","g","lineStyle","drawRoundedRect","y","PixiPlugin","registerPIXI","gsap","registerPlugin","map","Map","content","image","children","canvasWidth","canvasHeight","blur","viewportRef","backgroundRef","moveCenter","scale","to","duration","pixi","renderLabel","label","index","position","pointertap","labelClick","handleLabelClick","width","options","transparent","ParticleEmitter","applyProps","instance","oldProps","newProps","config","newP","applyDefaultProps","emitter","this","_emitter","particles","from","elapsed","performance","now","emit","tick","raf","requestAnimationFrame","update","willUnmount","cancelAnimationFrame","Overview","contentItem","background","filter","ZoomBlurFilter","filters","strength","localPos","onUpdate","onComplete","labelClicked","name","x","smoke","App","useState","overview","currentMap","setCurrentMap","setCanvasWidth","setCanvasHeight","resize","window","innerWidth","outerWidth","innerHeight","outerHeight","addEventListener","removeEventListener","warehouse","Boolean","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.28ee7122.chunk.js","sourcesContent":["import React from \"react\";\nimport { Viewport as PixiViewport, ClickEventData } from \"pixi-viewport\";\nimport { PixiComponent, useApp } from \"@inlet/react-pixi\";\n\ninterface Props {\n  children: React.ReactNode;\n  onClick?(event: ClickEventData): void;\n  screenWidth: number,\n  screenHeight: number,\n  worldWidth: number,\n  worldHeight: number,\n  minScale?: number;\n  maxScale?: number;\n}\n\n/** Viewport leverages pixi-viewport to create a pannable map \n * https://davidfig.github.io/pixi-viewport/jsdoc/\n */\nconst Viewport = React.forwardRef<PixiViewport, any>((props, ref) => {\n  const app = useApp();\n  if (app) {\n      // Perhaps this is better moved somewhere else\n      const cursor = `url('${process.env.PUBLIC_URL}/img/cursors/dwarven_gauntlet_extra_6.png'), auto`;\n      app.renderer.plugins.interaction.cursorStyles.pointer = cursor;\n  }\n  return <PixiComponentViewport app={app} {...props} ref={ref} />;  \n})\n\ninterface PixiComponentProps {\n    app: PIXI.Application;\n}\n\nconst PixiComponentViewport = PixiComponent(\"Viewport\", {\n  create: (props: PixiComponentProps & Props) => {\n    const viewport = new PixiViewport({\n      screenWidth: props.screenWidth,\n      screenHeight: props.screenHeight,\n      worldWidth: props.worldWidth,\n      worldHeight: props.worldHeight,\n      ticker: props.app.ticker,\n      interaction: props.app.renderer.plugins.interaction,\n      // the interaction module is important for wheel to work properly when renderer.view is placed or scaled\n    });\n\n    const { \n      minScale = .25, \n      maxScale = 1 \n    } = props;\n    \n    viewport\n      .drag()\n      .pinch()\n      .wheel()\n      .clamp({ direction: 'x' })\n      .clampZoom({ minScale, maxScale })\n      .decelerate();\n\n    return viewport;\n  },\n});\nexport default Viewport;\n","import React, { useMemo, useRef, useEffect } from \"react\";\nimport { Container, Graphics, Text } from \"@inlet/react-pixi\";\nimport * as PIXI from 'pixi.js';\n\ninterface Props {\n  text: string;\n}\n\nconst labelMaxHeight = 150 + 60; // three lines plus padding\n//const Label = (props: Props & React.ComponentProps<typeof Container>) => {\nconst Label = React.forwardRef<PIXI.Container, Props & React.ComponentProps<typeof Container>>((props, ref) => {\n\n  const textRef = useRef<PIXI.Text>(null);\n  const labelWidth = 500;\n  const padding = 30;\n  const borderRadius = 4;\n  const roundRadius = 10;\n  const {text} = props;\n\n  const style = useMemo(() => {\n    return new PIXI.TextStyle({\n      align: 'center',\n      lineHeight: 50,\n      wordWrap: true,\n      wordWrapWidth: labelWidth - 2 * padding,\n      fontFamily: '\"Source Sans Pro\", Helvetica, sans-serif',\n      fontSize: 40,\n      textBaseline: \"alphabetic\",\n      fontWeight: \"400\"\n    });\n  }, []);\n\n  const textBoxHeight = useMemo(() => {\n    const metrics = PIXI.TextMetrics.measureText(text, style);\n    const height = Math.min(metrics.height + 2 * padding, labelMaxHeight);\n    return height;\n  }, [text, style]);\n\n  useEffect(() => {\n    const textCmp = textRef.current as any as PIXI.Text;\n\n    const maskGraphics = new PIXI.Graphics();\n    maskGraphics.beginFill(0xBADA55);\n    maskGraphics.drawRect(-labelWidth / 2 + padding, 0, labelWidth-padding * 2, textBoxHeight - padding * 2);\n    maskGraphics.endFill(); \n\n    textCmp.mask = maskGraphics;\n    textCmp.addChild(maskGraphics);\n}, [textBoxHeight, textRef]);\n\n  return (\n    <Container \n      interactive\n      anchor={[0.5, 1]}\n      ref={ref}\n      {...props}\n    >\n      <Graphics\n        draw={(g:PIXI.Graphics) => {\n          g.lineStyle(borderRadius, 0x000000);\n          g.beginFill(0xffffff);\n          // x, y, width, height, radius\n          g.drawRoundedRect(-labelWidth / 2, 0, labelWidth, -textBoxHeight, roundRadius);\n          g.endFill();\n        }\n      }>\n          <Text \n            ref={textRef}  \n            text={text}\n            anchor={[0.5, 0]}\n            y={-textBoxHeight + padding}\n            style={style}          \n         />\n\n      </Graphics>\n      </Container>\n  )\n});\nexport default Label;","import React, { useState, useRef, useEffect, useMemo } from \"react\";\nimport { Viewport as PixiViewport } from \"pixi-viewport\";\nimport sound from 'pixi-sound';\nimport Marker from \"./pixi/Marker\";\nimport { Stage, Sprite, Text, Container, Graphics } from \"@inlet/react-pixi\";\nimport ContentModal from \"./contentModal\";\nimport Viewport from \"./pixi/Viewport\";\nimport * as PIXI from 'pixi.js';\nimport { PixiPlugin } from 'gsap/all';\nimport { gsap } from 'gsap'\nimport Conveyor from \"./pixi/Conveyor\";\nimport Label from \"./pixi/Label\";\nimport { ILabel } from \"../common/constants\";\n\nPixiPlugin.registerPIXI(PIXI);\ngsap.registerPlugin(PixiPlugin);\n\nif (process.env.NODE_ENV === \"development\") {\n  // @ts-ignore\n  window.__PIXI_INSPECTOR_GLOBAL_HOOK__ && window.__PIXI_INSPECTOR_GLOBAL_HOOK__.register({ PIXI: PIXI });\n}\n\ninterface Props {\n  content: ILabel[];\n  image: string;\n  children?: React.ReactNode;\n  worldWidth: number;\n  worldHeight: number;\n  canvasWidth: number;\n  canvasHeight: number;\n  blur?: boolean;\n  labelClick: (label: ILabel, viewport: PixiViewport, background: PIXI.Sprite) => void;\n}\n\nconst Map = (props: Props) => {\n  const { \n    content,\n    image, \n    children,\n    worldWidth, \n    worldHeight, \n    canvasWidth, \n    canvasHeight, \n    blur = false } = props;\n  const viewportRef = useRef<PixiViewport>(null);\n  const backgroundRef = useRef<PIXI.Sprite>(null);\n\n  useEffect(() => {\n    // Center the map\n    if (viewportRef.current) {\n      const viewport = viewportRef.current;\n      viewport.moveCenter(worldWidth / 2, worldHeight / 2);  \n      viewport.scale = new PIXI.Point(0.5, 0.5);\n    }\n  }, [canvasWidth, canvasHeight, worldWidth, worldHeight]);\n\n//   useEffect(() => {\n//     viewportRef.current?.on(\"zoomed\", (event) => { \n//       const factor = 1 / (event.viewport as any).lastViewport.scaleX;;\n//       labelRef.current!.scale = new PIXI.Point(factor, factor);\n// //      console.log(labelRef)\n//     });\n//     // todo normalize zoom on labels\n//   }, [viewportRef])\n\n  useEffect(() => {\n    // Blur the map when situation is selected\n    if (blur) {\n      gsap.to(viewportRef.current, {duration: .5, pixi: {blur:20}});\n    } else {\n      gsap.to(viewportRef.current, {duration: .5, pixi: {blur:0}});\n    }\n  }, [blur]);\n\n  const handleLabelClick = (label: ILabel) => {\n    props.labelClick(label, viewportRef.current!, backgroundRef.current!);\n  }\n\n  const renderLabel = (label: ILabel, index: number) => {\n    const position = new PIXI.Point(label.position[0], label.position[1]);\n\n    return (\n      <Label \n        text={label.text}\n        position={position}\n        pointertap={() => handleLabelClick(label)}\n        interactive={true}\n      />\n    ); \n  }\n\n  return (\n      <Stage width={canvasWidth} height={canvasHeight} options={{transparent: true}} >\n      <Viewport \n        screenWidth={canvasWidth} screenHeight={canvasHeight} worldWidth={worldWidth} worldHeight={worldHeight} ref={viewportRef} >\n        <Sprite image={`${process.env.PUBLIC_URL}/${image}`} ref={backgroundRef} >\n          {children}\n          {content.map((label, index) => renderLabel(label, index))}\n        </Sprite>\n      </Viewport>\n    </Stage>\n  )\n};\n\nexport default Map;","import React, { useRef, useEffect, useState } from 'react';\nimport * as PIXI from 'pixi.js';\nimport { Stage, Sprite } from '@inlet/react-pixi';\nimport Viewport from './components/pixi/Viewport';\nimport { Viewport as PixiViewport } from \"pixi-viewport\";\nimport Marker from './components/pixi/Marker';\nimport { PixiPlugin } from 'gsap/all';\nimport './App.css';\nimport ParticleEmitter from './components/pixi/ParticleEmitter';\nimport content from './content/content.json';\nimport ContentModal from './components/contentModal';\nimport Overview from './components/Overview';\nimport IntroModal from './components/introModal/introModal';\nimport Map from './components/Map';\nimport { ILabel } from './common/constants';\n\nenum map {\n  overview,\n  warehouse\n}\n\nfunction App() {\n\n\n  const [intro, setIntro] = useState(true);\n  const [currentMap, setCurrentMap] = useState(map.overview);\n\n  const [canvasWidth, setCanvasWidth] = useState(1200);\n  const [canvasHeight, setCanvasHeight] = useState(600);\n\n  useEffect(() => {\n    // This will set the dimensions of the canvas to that of the window\n    const resize = () => {\n      const width = Math.min(window.innerWidth, window.outerWidth);\n      const height = Math.min(window.innerHeight, window.outerHeight);\n      setCanvasWidth(width);\n      setCanvasHeight(height); \n    }\n    resize();\n\n    window.addEventListener(\"resize\", resize);\n    return () => {\n      window.removeEventListener(\"resize\", resize);\n    };\n  }, []);\n\n  const handleOverviewLabelClicked = (content: ILabel) => {\n    setCurrentMap(map.warehouse);\n  }\n\n  return (\n    <>\n      {/* { intro && (<IntroModal selectedAvatar={avatar} onClose={() => {setIntro(false)}} onChangeAvatar={setAvatar}/>)} */}\n      { currentMap === map.overview && (\n        <Overview \n          content={content}\n          labelClicked={handleOverviewLabelClicked}\n          canvasWidth={canvasWidth}\n          canvasHeight={canvasHeight}\n        /> )\n      }\n    </>  \n  )\n};\n\nexport default App;\n\n","import { PixiComponent, applyDefaultProps, Container } from \"@inlet/react-pixi\";\nimport * as PIXI  from 'pixi.js';\nimport * as particles from 'pixi-particles';\n\n\ninterface Props  {\n    image: string;\n    config: particles.OldEmitterConfig | particles.EmitterConfig;\n};\n\nconst ParticleEmitter = PixiComponent<Props & React.ComponentProps<typeof Container>, PIXI.ParticleContainer>(\"ParticleEmitter\", {\n    create() {\n      return new PIXI.ParticleContainer();\n    },\n\n    applyProps(instance, oldProps: Props, newProps: Props) {\n      const { image, config, ...newP } = newProps;\n  \n      // apply rest props to PIXI.ParticleContainer\n      applyDefaultProps(instance, oldProps, newP);\n      \n      let emitter = (this as any)._emitter;\n      if (!emitter) {\n        emitter = new particles.Emitter(\n          instance,\n          [PIXI.Texture.from(image)],\n          config\n        );\n  \n        let elapsed = performance.now();\n  \n        const tick = () => {\n          emitter.raf = requestAnimationFrame(tick);\n          const now = performance.now();\n          emitter.update((now - elapsed) * 0.0003);\n  \n          elapsed = now;\n        };  \n        emitter.emit = true;\n\n        tick();\n      }\n      (this as any)._emitter = emitter;\n    },\n\n    willUnmount() {\n      if ((this as any)._emitter) {\n        (this as any)._emitter.emit = false;\n        cancelAnimationFrame((this as any)._emitter.raf);\n      }\n    }\n});\n\nexport default ParticleEmitter;","import React, { useState, useRef, useEffect, useMemo } from \"react\";\nimport { Viewport as PixiViewport } from \"pixi-viewport\";\nimport sound from 'pixi-sound';\nimport Marker from \"./pixi/Marker\";\nimport { Stage, Sprite } from \"@inlet/react-pixi\";\nimport ContentModal from \"./contentModal\";\nimport Viewport from \"./pixi/Viewport\";\nimport * as PIXI from 'pixi.js';\nimport { PixiPlugin } from 'gsap/all';\nimport { gsap } from 'gsap'\nimport Conveyor from \"./pixi/Conveyor\";\nimport { ILabel } from \"../common/constants\";\nimport Label from \"./pixi/Label\";\nimport Map from \"./Map\";\nimport ParticleEmitter from \"./pixi/ParticleEmitter\";\nimport {ZoomBlurFilter} from '@pixi/filter-zoom-blur';\nimport smoke from './../smoke.json';\n\ninterface Props {\n  content: ILabel[];\n  children?: React.ReactNode;\n  canvasWidth: number;\n  canvasHeight: number;\n  labelClicked: (contentItem: ILabel) => void;\n}\n\nconst Overview = (props: Props) => {\n  const {content, canvasWidth, canvasHeight} = props;\n  \n  const handleLabelClick = (contentItem: ILabel, viewport: PixiViewport, background: PIXI.Sprite ) => {\n    const filter = new ZoomBlurFilter(0.05, [canvasWidth / 2, canvasHeight / 2], 300)\n    background.filters = [filter];\n    gsap.to(filter, {\n      duration: .8,\n      strength: .2\n    });\n    const localPos = new PIXI.Point(contentItem.position[0], contentItem.position[1] - 30);\n    \n    gsap.to(viewport, {\n      duration: .8,\n      onUpdate: () => {\n        viewport.moveCenter(localPos);  \n      },\n      pixi: {\n        scale: 1\n      },\n      onComplete: () => {\n        props.labelClicked(contentItem);\n      }\n    });\n\n  }\n\n  return ( \n    <Map\n      content={content}\n      image=\"images/map/landscape.png\"\n      worldWidth={6528}\n      worldHeight={2202}\n      canvasWidth={canvasWidth}\n      canvasHeight={canvasHeight}\n      labelClick={handleLabelClick}\n    >\n       <ParticleEmitter\n          name=\"smoke\"\n          x={2491}\n          y={793}\n          image={`${process.env.PUBLIC_URL}/images/map/smoke.png`} \n          config={smoke} \n        />\n    </Map>\n  )\n};\n\nexport default Overview;","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}